# Discord 出勤確認Bot

Discordの特定のチャンネルに定期的にメッセージを投稿し、その投稿にリアクションしたユーザーを自動で集計・報告するBotです。

## 主な機能

- **週次の自動投稿**: 毎週指定した曜日・時刻に、出勤確認のメッセージを自動で投稿します。
- **リアクションの自動集計**: 次の投稿が行われる直前に、前回の投稿に付けられたリアクションを集計します。
- **重複しないユーザーリスト**: 同じユーザーが複数のリアクションをしても、1名としてカウントします。
- **結果の指定されたチャンネルへの報告**: 集計結果を指定されたチャンネルにメンション付きで報告します。

## 必要なもの

- Python 3.8以上
- Discord Botのトークン
- Discordサーバーと、Botがメッセージを読み書きできるチャンネル

## セットアップ方法

1.  **リポジトリをクローンします。**
    ```bash
    git clone https://github.com/yagatsuki/attendance-bot.git
    cd attendance-bot
    ```

2.  **必要なライブラリをインストールします。**
    ```bash
    pip install -r requirements.txt
    ```

3.  **`.env` ファイルを作成します。**
    プロジェクトのルートディレクトリ（`requirements.txt` と同じ場所）に `.env` という名前のファイルを作成し、以下の内容を記述します。

    ```env
    TOKEN=YOUR_DISCORD_BOT_TOKEN
    CHANNEL_ID=YOUR_POST_CHANNEL_ID
    REACTION_CHANNEL_ID=YOUR_REACTION_REPORT_CHANNEL_ID
    ```

4.  **環境変数を設定します。**
    - `TOKEN`: あなたのDiscord Botのトークンに置き換えてください。
    - `CHANNEL_ID`: Botが毎週メッセージを投稿するチャンネルのIDに置き換えてください。
    - `REACTION_CHANNEL_ID`: リアクションの集計結果を報告するチャンネルのIDに置き換えてください。

    **※チャンネルIDの取得方法:**
    Discordの「ユーザー設定」→「詳細設定」で「開発者モード」をオンにした後、対象のチャンネルを右クリックして「チャンネルIDをコピー」を選択します。

## 実行方法

以下のコマンドでBotを起動します。

```bash
python app/main.py
```

Botが正常に起動すると、コンソールにログイン情報が表示され、指定したスケジュールに従って自動でタスクを実行します。

## Botの動作仕様

- **投稿**: 毎週木曜日の日本時間 10:00 に `CHANNEL_ID` で指定されたチャンネルへ出勤確認メッセージを投稿します。
- **集計**: 次の木曜日の投稿直前に、前回の投稿へのリアクションを集計します。
- **報告**: 集計結果を `REACTION_CHANNEL_ID` で指定されたチャンネルへ投稿します。

## デプロイ

このプロジェクトには、Koyebなどのホスティングサービスにデプロイするための `Dockerfile` と、Webサーバーを起動するための `app/server.py` が含まれています。
